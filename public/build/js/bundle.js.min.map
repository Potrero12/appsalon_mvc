{"version":3,"sources":["app.js","buscador.js"],"names":["paso","pasoInicial","pasoFinal","cita","id","nombre","fecha","hora","servicios","iniciarApp","mostrarSeccion","tabs","botonesPaginador","paginaSiguiente","paginaAnterior","consultarAPI","nombreCliente","idCliente","seleccionarFecha","seleccionarHora","mostrarResumen","document","querySelectorAll","forEach","boton","addEventListener","e","parseInt","target","dataset","seccionAnterior","querySelector","classList","remove","pasoSelector","add","tabAnterior","async","url","resultado","fetch","mostrarServicios","json","error","console","log","servicio","precio","nombreServicio","createElement","textContent","precioServicio","servicioDiv","idServicio","onclick","seleccionarServicio","appendChild","divServicio","some","agregado","filter","value","dia","Date","getUTCDay","includes","mostrarAlerta","horaCita","split","resumen","firstChild","removeChild","Object","values","length","headingServicios","contenedorServicio","textoServicio","innerHTML","headingCita","feachaObj","mes","getMonth","getDate","year","getFullYear","fechaFormateada","UTC","toLocaleDateString","weekday","month","day","fechaCita","botonReservar","reservarCita","map","datos","FormData","append","respuesta","method","body","Swal","fire","icon","title","text","button","then","window","location","reload","catch","err","mensaje","tipo","elemento","desaparece","alertaPrevia","divMensaje","setTimeout","alert"],"mappings":"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","file":"bundle.js","sourcesContent":["let paso = 1;\r\nconst pasoInicial = 1;\r\nconst pasoFinal = 3;\r\n\r\nconst cita = {\r\n    id: '',\r\n    nombre: '',\r\n    fecha: '',\r\n    hora: '',\r\n    servicios: []\r\n};\r\n\r\ndocument.addEventListener('DOMContentLoaded', function(){\r\n    iniciarApp();\r\n});\r\n\r\nfunction iniciarApp(){\r\n    mostrarSeccion(); //muestra y oculta las secciones\r\n    tabs(); //cambia la seccion cuando se presiones los tabs\r\n    botonesPaginador(); //agrega o quita los botones del paginadores\r\n    paginaSiguiente();\r\n    paginaAnterior();\r\n    consultarAPI(); //consulta la api en el backen en php\r\n    nombreCliente(); //añade el nombre del client al objeto de cita\r\n    idCliente(); //añade el id del client al objeto de cita\r\n    seleccionarFecha(); //añade la fecha de la cita en el objeto\r\n    seleccionarHora(); //añade la hora de la cita en el objeto\r\n    mostrarResumen(); //muestra el resumen de la cita\r\n\r\n}\r\n\r\nfunction tabs(){\r\n    const botones = document.querySelectorAll('.tabs button');\r\n\r\n    botones.forEach(boton => {\r\n        boton.addEventListener('click', function(e){\r\n            paso = parseInt(e.target.dataset.paso);\r\n            mostrarSeccion();\r\n            \r\n            botonesPaginador();\r\n\r\n        })\r\n    })\r\n    \r\n}\r\n\r\nfunction mostrarSeccion(){\r\n\r\n    // ocultar la seccion que tenga la clase mostra\r\n    const seccionAnterior = document.querySelector('.mostrar');\r\n    if(seccionAnterior){\r\n        seccionAnterior.classList.remove('mostrar');\r\n    }\r\n\r\n\r\n    // seleccionar la seccion con el paso...\r\n    const pasoSelector = `#paso-${paso}`;\r\n    const seccion = document.querySelector(pasoSelector);\r\n    seccion.classList.add('mostrar');\r\n\r\n    // quita la clase anctual al anterori tab\r\n    const tabAnterior = document.querySelector('.actual');\r\n    if(tabAnterior){\r\n        tabAnterior.classList.remove('actual');\r\n    }\r\n\r\n    // resaltar el tab actual\r\n    const tab = document.querySelector(`[data-paso=\"${paso}\"]`);\r\n    tab.classList.add('actual');\r\n}\r\n\r\nfunction botonesPaginador(){\r\n\r\n    const paginaAnterior = document.querySelector('#anterior');\r\n    const paginaSiguiente = document.querySelector('#siguiente');\r\n\r\n    if(paso === 1){\r\n        paginaAnterior.classList.add('ocultar');\r\n        paginaSiguiente.classList.remove('ocultar');\r\n    } else  if(paso === 3) {\r\n        paginaAnterior.classList.remove('ocultar');\r\n        paginaSiguiente.classList.add('ocultar');\r\n\r\n        mostrarResumen();\r\n    } else {\r\n        paginaAnterior.classList.remove('ocultar');\r\n        paginaSiguiente.classList.remove('ocultar');\r\n    }\r\n\r\n    mostrarSeccion();\r\n\r\n}\r\n\r\nfunction paginaSiguiente(){\r\n    const paginaAnterior = document.querySelector('#anterior');\r\n    paginaAnterior.addEventListener('click', function(){\r\n        if(paso <= pasoInicial) return;\r\n\r\n        paso--;\r\n        \r\n        botonesPaginador();\r\n    });\r\n}\r\n\r\nfunction paginaAnterior(){\r\n    const paginasiguiente = document.querySelector('#siguiente');\r\n    paginasiguiente.addEventListener('click', function(){\r\n        if(paso >= pasoFinal) return;\r\n\r\n        paso++;\r\n        \r\n        botonesPaginador();\r\n    });\r\n}\r\n\r\nasync function consultarAPI(){\r\n\r\n    try {\r\n\r\n        const url = 'http://localhost:3000/api/servicios';\r\n        const resultado = await fetch(url);\r\n        const servicios = await resultado.json();\r\n        mostrarServicios(servicios);\r\n\r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n\r\n}\r\n\r\nfunction mostrarServicios(servicios) {\r\n\r\n    servicios.forEach(servicio => {\r\n        const {id, nombre, precio} = servicio;\r\n        \r\n        const nombreServicio = document.createElement('p');\r\n        nombreServicio.classList.add('nombre-servicio');\r\n        nombreServicio.textContent = nombre;\r\n\r\n        const precioServicio = document.createElement('P');\r\n        precioServicio.classList.add('precio-servicio');\r\n        precioServicio.textContent = `$${precio}`;\r\n\r\n        const servicioDiv = document.createElement('DIV');\r\n        servicioDiv.classList.add('servicio');\r\n        servicioDiv.dataset.idServicio = id;\r\n        servicioDiv.onclick = function(){\r\n            seleccionarServicio(servicio)\r\n        };\r\n\r\n        servicioDiv.appendChild(nombreServicio);\r\n        servicioDiv.appendChild(precioServicio);\r\n\r\n        document.querySelector('#servicios').appendChild(servicioDiv);\r\n    });\r\n}\r\n\r\nfunction seleccionarServicio(servicio) {\r\n    const { id } = servicio;\r\n    const { servicios } = cita;\r\n\r\n    // identificar al elemnto que se da el click\r\n    const divServicio = document.querySelector(`[data-id-servicio=\"${id}\"]`);\r\n\r\n    // comprobar si un servicio ya fue agregado o quitarlo\r\n    if(servicios.some(agregado => agregado.id === id)){\r\n        // eliminarlo\r\n        cita.servicios = servicios.filter(agregado => agregado.id !== id);\r\n        divServicio.classList.remove('seleccionado');\r\n    } else {\r\n        // agregarlo\r\n        cita.servicios = [...servicios, servicio];\r\n        divServicio.classList.add('seleccionado');\r\n    }\r\n\r\n    console.log(cita);\r\n\r\n}\r\n\r\nfunction nombreCliente(){\r\n    const nombre = document.querySelector('#nombre').value;\r\n    \r\n    cita.nombre = nombre;\r\n}\r\n\r\nfunction idCliente(){\r\n    const id = document.querySelector('#id').value;\r\n    \r\n    cita.id = id;\r\n}\r\n\r\nfunction seleccionarFecha(){\r\n    const inputFecha = document.querySelector('#fecha');\r\n    inputFecha.addEventListener('input', function(e){\r\n        const dia = new Date(e.target.value).getUTCDay();\r\n\r\n        if([6,0].includes(dia)){\r\n            e.target.value = '';\r\n            mostrarAlerta('Los sabados y domingos no hay servicio', 'error', '.formulario');\r\n        } else {\r\n            cita.fecha = e.target.value;\r\n        }\r\n        \r\n    });\r\n\r\n}\r\n\r\nfunction seleccionarHora(){\r\n    const inputHora = document.querySelector('#hora');\r\n    inputHora.addEventListener('input',  function(e){\r\n\r\n        const horaCita = e.target.value;\r\n        const hora = horaCita.split(\":\")[0];\r\n        if(hora < 10 || hora > 18) {\r\n            e.target.value = '';\r\n            mostrarAlerta('Hora no valida','error', '.formulario');\r\n        } else {\r\n            cita.hora = horaCita\r\n        }\r\n    });\r\n}\r\n\r\nfunction mostrarResumen(){\r\n    const resumen = document.querySelector('.contenido-resumen');\r\n\r\n    // // limpiar el contenido de resumen\r\n    while(resumen.firstChild){\r\n        resumen.removeChild(resumen.firstChild);\r\n    }\r\n\r\n    if(Object.values(cita).includes('') || cita.servicios.length === 0) {\r\n        mostrarAlerta('Faltan datos de servicios, Fecha u Hora', 'error', '.contenido-resumen', false);\r\n        return;\r\n    }\r\n\r\n    // formatear el div del resumen\r\n    const { nombre, fecha, hora, servicios } = cita;\r\n\r\n    // heading para servicios resumen\r\n    const headingServicios = document.createElement('H3')\r\n    headingServicios.textContent = 'Resumen de Servicios';\r\n    resumen.appendChild(headingServicios);\r\n\r\n    // iterando y mostrando servicios\r\n    servicios.forEach(servicio => {\r\n        const { id, nombre, precio } = servicio;\r\n        const contenedorServicio = document.createElement('DIV');\r\n        contenedorServicio.classList.add('contenedor-servicio');\r\n\r\n        const textoServicio = document.createElement('P');\r\n        textoServicio.textContent = nombre;\r\n\r\n        const precioServicio = document.createElement('P');\r\n        precioServicio.innerHTML = `<span>Precio:</span>$${precio}`;\r\n\r\n        contenedorServicio.appendChild(textoServicio);\r\n        contenedorServicio.appendChild(precioServicio);\r\n\r\n        resumen.appendChild(contenedorServicio);\r\n    });\r\n\r\n    // heading para cita resumen\r\n    const headingCita = document.createElement('H3')\r\n    headingCita.textContent = 'Resumen de Cita';\r\n    resumen.appendChild(headingCita);\r\n\r\n    const nombreCliente = document.createElement('P');\r\n    nombreCliente.innerHTML = `<span>Nombre:</span> ${nombre}`;\r\n\r\n    // formatear la fecha en español\r\n    const feachaObj = new Date(fecha);\r\n    const mes = feachaObj.getMonth();\r\n    const dia = feachaObj.getDate() + 2;\r\n    const year = feachaObj.getFullYear();\r\n\r\n    const fechaUTC = new Date(Date.UTC(year, mes, dia));\r\n\r\n    const opciones = {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'};\r\n    const fechaFormateada = fechaUTC.toLocaleDateString('es-CO', opciones);\r\n\r\n    const fechaCita = document.createElement('P');\r\n    fechaCita.innerHTML = `<span>Fecha:</span> ${fechaFormateada}`;\r\n\r\n    const horaCita = document.createElement('P');\r\n    horaCita.innerHTML = `<span>Hora:</span> ${hora} Horas`;\r\n\r\n    // boton para crear una cita\r\n    const botonReservar = document.querySelector('BUTTON');\r\n    botonReservar.classList.add('boton');\r\n    botonReservar.textContent = 'Reservar Cita';\r\n    botonReservar.onclick = reservarCita;\r\n\r\n    resumen.appendChild(nombreCliente);\r\n    resumen.appendChild(fechaCita);\r\n    resumen.appendChild(horaCita);\r\n    resumen.appendChild(botonReservar)\r\n\r\n}\r\n\r\nasync function reservarCita(){\r\n    \r\n    const {nombre, fecha, hora, servicios, id} = cita;\r\n\r\n    const idServicio = servicios.map(servicio => servicio.id);\r\n\r\n    const datos = new FormData();\r\n    datos.append('usuarioId', id);\r\n    datos.append('fecha', fecha);\r\n    datos.append('hora', hora);\r\n    datos.append('servicios', idServicio);\r\n\r\n    try {\r\n    // peticion hacia la api\r\n    const url = 'http://localhost:3000/api/citas';\r\n    const respuesta = await fetch(url, {\r\n        method: 'POST',\r\n        body: datos\r\n        \r\n    });\r\n    const resultado = await respuesta.json();\r\n\r\n    if(resultado.resultado){\r\n        Swal.fire({\r\n            icon: 'success',\r\n            title: 'Cita Creada',\r\n            text: 'Tu cita fue creada correctamente',\r\n            button: 'OK'\r\n        }).then(() => {\r\n            window.location.reload();\r\n        }).catch((err) => {\r\n            console.log(err);\r\n        });;\r\n    }\r\n        \r\n    } catch (error) {\r\n        Swal.fire({\r\n            icon: 'error',\r\n            title: 'Error Cita',\r\n            text: 'Se genero un error al generar la cita',\r\n            button: 'OK'\r\n        })\r\n    }\r\n\r\n    // console.log([...datos]);\r\n\r\n}\r\n\r\nfunction mostrarAlerta(mensaje, tipo, elemento, desaparece = true) {\r\n\r\n    // previene que se generar multiples alertas\r\n    const alertaPrevia  =  document.querySelector('.alerta');\r\n    if(alertaPrevia) {\r\n        alertaPrevia.remove();\r\n    }\r\n\r\n    const divMensaje = document.createElement('DIV');\r\n    divMensaje.textContent = mensaje;\r\n    divMensaje.classList.add('alerta');\r\n    divMensaje.classList.add(tipo);\r\n\r\n    const formulario = document.querySelector(elemento);\r\n    formulario.appendChild(divMensaje);\r\n\r\n    if(desaparece) {\r\n        setTimeout(() => {\r\n            divMensaje.remove();\r\n        },3000)\r\n    }\r\n\r\n}\r\n","document.addEventListener('DOMContentLoaded', function(){\r\n    iniciarApp();\r\n});\r\n\r\nfunction iniciarApp(){\r\n    alert('desde buscador')\r\n}"]}